buildPack: none
pipelineConfig:
  pipelines:
    release:
      pipeline:
        agent:
          image: amazon/aws-cli
        stages:
        - name: release
          steps:
          - sh: |
              aws eks --region us-east-2 update-kubeconfig --name todo-infra
              helm upgrade --install todo-app ./helm-todo-app
          env:
          - name: AWS_ACCESS_KEY_ID
            valueFrom:
              secretKeyRef:
                name: aws-credentials
                key: AWS_ACCESS_KEY_ID
          - name: AWS_SECRET_ACCESS_KEY
            valueFrom:
              secretKeyRef:
                name: aws-credentials
                key: AWS_SECRET_ACCESS_KEY
          - name: AWS_DEFAULT_REGION
            value: us-east-2